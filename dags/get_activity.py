"""
get_activity
DAG auto-generated by Astro Cloud IDE.
"""

from airflow.decorators import dag
from airflow.models import Variable
from astro import sql as aql
import pandas as pd
import pendulum

from airflow.models import Variable
import requests

@aql.dataframe(task_id="fetch_activity")
def fetch_activity_func():
    r = requests.get(Variable.get('API'))
    return r.json()

@aql.dataframe(task_id="print_activity")
def print_activity_func(fetch_activity: pd.DataFrame):
    print(fetch_activity)

default_args={
    "owner": "robel_tewelde@hotmail.com,Open in Cloud IDE",
}

@dag(
    default_args=default_args,
    schedule="0 0 * * *",
    start_date=pendulum.from_format("2024-01-13", "YYYY-MM-DD").in_tz("UTC"),
    catchup=False,
    owner_links={
        "robel_tewelde@hotmail.com": "mailto:robel_tewelde@hotmail.com",
        "Open in Cloud IDE": "https://cloud.astronomer.io/clr99m29c024401pbu3y6ukte/cloud-ide/clrax1u9e03k301pbwpyfoex4/clrbr3zvc03x501pb7vv9ext4",
    },
)
def get_activity():
    fetch_activity = fetch_activity_func()

    print_activity = print_activity_func(
        fetch_activity,
    )

dag_obj = get_activity()
